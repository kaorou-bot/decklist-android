# MTGO Decklist Manager 任务清单

> 使用说明：完成一项任务后，在 `[ ]` 中添加 `x` 变成 `[x]`

---

## 📋 总体进度

- [ ] v4.1.0 - 导出与搜索
- [ ] v4.1.5 - 体验优化
- [ ] v4.2.0 - 套牌分析
- [ ] v4.2.5 - 性能优化
- [ ] v4.3.0 - 元游戏分析
- [ ] v4.4.0 - 笔记与对比
- [ ] v4.5.0 - 离线与多数据源
- [ ] v4.6.0 - 比赛工具
- [ ] v4.7.0 - 社交功能
- [ ] v4.8.0 - 赛制扩充
- [ ] v5.0.0 - AI 助手

---

## 🚀 v4.1.0 - 导出与搜索（第 1-2 周）

### 模块 1.1：套牌导出功能

#### 后端开发
- [ ] 创建 `DecklistExporter.kt` 工具类
- [ ] 实现 MTGO `.dek` 格式导出
- [ ] 实现 Arena `.json` 格式导出
- [ ] 实现纯文本 `.txt` 格式导出
- [ ] 实现 Moxfield 链接生成
- [ ] 实现复制到剪贴板功能
- [ ] 实现文件保存到本地存储
- [ ] 添加单元测试

#### UI 开发
- [ ] `DeckDetailActivity` 添加导出菜单项
- [ ] 创建导出格式选择对话框 `ExportFormatDialog`
- [ ] 添加分享按钮和逻辑
- [ ] 添加文件保存成功提示
- [ ] 添加错误处理和提示

#### 测试
- [ ] 测试 MTGO 格式导出
- [ ] 测试 Arena 格式导出
- [ ] 测试文本格式导出
- [ ] 测试 Moxfield 链接生成
- [ ] 测试文件保存功能
- [ ] 测试分享功能（微信/QQ等）

---

### 模块 1.2：卡牌搜索功能

#### 数据库
- [ ] 创建 `search_history` 表
- [ ] 创建 `SearchHistoryEntity.kt`
- [ ] 创建 `SearchHistoryDao.kt`
- [ ] 更新 `AppDatabase.kt` 版本和迁移

#### 后端开发
- [ ] 创建 `SearchActivity.kt`
- [ ] 创建 `SearchViewModel.kt`
- [ ] 创建 `SearchAdapter.kt`
- [ ] 创建 `FilterDialog.kt` 高级筛选对话框
- [ ] 实现基础搜索功能
- [ ] 实现搜索历史记录
- [ ] 实现中英文名搜索
- [ ] 实现模糊搜索
- [ ] 实现搜索结果缓存

#### 高级筛选功能
- [ ] 实现颜色筛选（WUBRG）
- [ ] 实现法术力值范围筛选
- [ ] 实现卡牌类型筛选
- [ ] 实现稀有度筛选
- [ ] 实现赛制合法性筛选
- [ ] 实现组合筛选逻辑

#### UI 开发
- [ ] `MainActivity` 顶部添加 SearchView
- [ ] 设计搜索结果卡片布局
- [ ] 设计筛选按钮和对话框UI
- [ ] 实现搜索结果动画
- [ ] 实现空状态提示
- [ ] 实现加载状态

#### 测试
- [ ] 测试中文搜索
- [ ] 测试英文搜索
- [ ] 测试模糊搜索
- [ ] 测试各筛选条件
- [ ] 测试搜索历史
- [ ] 测试性能（大量结果）

---

## 🎨 v4.1.5 - 体验优化（穿插）

### UI/UX 优化

#### 深色模式
- [ ] 创建 `values-night/colors.xml`
- [ ] 创建 `values-night/themes.xml`
- [ ] 为所有颜色定义夜间版本
- [ ] 设置中添加深色模式开关
- [ ] 实现跟随系统主题

#### 手势操作
- [ ] 实现左滑收藏套牌
- [ ] 优化右滑删除动画
- [ ] 实现长按卡片快速预览
- [ ] 实现双击放大卡牌图片

#### 性能优化
- [ ] 优化列表滚动性能
- [ ] 优化图片加载（Glide 配置）
- [ ] 添加搜索防抖
- [ ] 优化数据库查询

#### Bug 修复
- [ ] 收集 v4.1.0 用户反馈
- [ ] 修复导出格式问题
- [ ] 修复搜索崩溃问题
- [ ] 修复 UI 显示问题

---

## 📊 v4.2.0 - 套牌分析（第 5-7 周）

### 模块 2.1：法术力曲线

#### 依赖添加
- [ ] 添加 MPAndroidChart 库依赖

#### 后端开发
- [ ] 创建 `ManaCurveAnalyzer.kt`
- [ ] 实现法术力值统计逻辑
- [ ] 实现图表数据生成

#### UI 开发
- [ ] `DeckDetailActivity` 添加"法术力曲线"标签页
- [ ] 创建 `ManaCurveFragment.kt`
- [ ] 实现柱状图展示
- [ ] 实现点击柱状图查看详情
- [ ] 添加图表配色和样式

#### 测试
- [ ] 测试各种套牌的法术力曲线
- [ ] 测试图表交互
- [ ] 测试数据准确性

---

### 模块 2.2：色曲线统计

#### 后端开发
- [ ] 创建 `ColorDistributionAnalyzer.kt`
- [ ] 实现颜色符号提取逻辑
- [ ] 实现颜色需求统计

#### UI 开发
- [ ] 添加饼图展示
- [ ] 添加颜色图例
- [ ] 添加百分比显示

#### 测试
- [ ] 测试单色套牌
- [ ] 测试多色套牌
- [ ] 测试五色套牌

---

### 模块 2.3：单卡统计

#### 数据库
- [ ] 创建 `card_statistics` 表
- [ ] 创建 `CardStatisticsEntity.kt`
- [ ] 创建 `CardStatisticsDao.kt`

#### 后端开发
- [ ] 创建 `CardStatisticsAnalyzer.kt`
- [ ] 实现套牌内单卡统计
- [ ] 实现跨套牌单卡统计
- [ ] 实现后台统计任务

#### UI 开发
- [ ] 添加单卡排名列表
- [ ] 添加出现频率显示
- [ ] 添加点击跳转功能

#### 测试
- [ ] 测试统计准确性
- [ ] 测试性能（大量卡牌）

---

### 模块 2.4：价格估算

#### API 集成
- [ ] 注册 CardMarket API
- [ ] 创建 `CardMarketApi.kt`
- [ ] 创建 `PriceProvider.kt` 接口
- [ ] 实现价格查询逻辑

#### 后端开发
- [ ] 创建 `PriceInfo` 数据模型
- [ ] 实现价格缓存机制
- [ ] 实现汇率转换（CNY/USD/EUR）

#### UI 开发
- [ ] `DeckDetailActivity` 添加"价格"标签页
- [ ] 创建 `PriceFragment.kt`
- [ ] 显示总套牌价格
- [ ] 显示单卡价格列表
- [ ] 显示最贵的10张卡
- [ ] 添加货币选择器

#### 测试
- [ ] 测试价格查询准确性
- [ ] 测试缓存有效性
- [ ] 测试货币转换
- [ ] 测试 API 限流处理

---

## 🎯 v4.2.5 - 性能与快捷方式（穿插）

### 快捷方式
- [ ] 创建桌面快捷方式（搜索卡牌）
- [ ] 创建桌面小部件（今日热门）
- [ ] 创建通知栏快捷搜索

### 缓存优化
- [ ] 实现套牌列表缓存
- [ ] 实现搜索结果缓存
- [ ] 实现图片缓存优化

### 动画优化
- [ ] 添加页面过渡动画
- [ ] 添加列表项动画
- [ ] 优化刷新动画

---

## 📈 v4.3.0 - 元游戏分析（第 10-12 周）

### 模块 3.1：Meta 统计

#### 数据库
- [ ] 创建 `meta_stats` 表
- [ ] 创建 `deck_archetype` 表
- [ ] 创建 `MetaStatsEntity.kt`
- [ ] 创建 `DeckArchetypeEntity.kt`
- [ ] 创建对应的 DAO

#### 后端开发
- [ ] 创建 `MetaStatisticsRepository.kt`
- [ ] 实现套牌 Archetype 分类逻辑
- [ ] 实现单卡热度统计
- [ ] 实现后台每日统计任务
- [ ] 实现 WorkManager 调度

#### UI 开发
- [ ] `MainActivity` 添加"Meta分析"底部标签
- [ ] 创建 `MetaAnalysisActivity.kt`
- [ ] 创建 `TopDecksFragment.kt`
- [ ] 创建 `TopCardsFragment.kt`
- [ ] 实现套牌排行榜
- [ ] 实现单卡排行榜
- [ ] 实现赛制选择器
- [ ] 实现时间范围选择器（7天/30天/90天）

#### 数据可视化
- [ ] 套牌 Archetype 占比饼图
- [ ] 单卡热度趋势图
- [ ] 赛制分布图

#### 测试
- [ ] 测试统计准确性
- [ ] 测试后台任务调度
- [ ] 测试图表性能

---

## 📝 v4.4.0 - 笔记与对比（第 13-14 周）

### 模块 4.1：笔记功能

#### 数据库
- [ ] 创建 `notes` 表
- [ ] 创建 `NoteEntity.kt`
- [ ] 创建 `NoteDao.kt`

#### 后端开发
- [ ] 创建 `NoteRepository.kt`
- [ ] 实现笔记 CRUD 操作

#### UI 开发
- [ ] `CardDetailActivity` 添加笔记按钮
- [ ] `DeckDetailActivity` 添加笔记按钮
- [ ] 创建 `NoteActivity.kt`（笔记列表）
- [ ] 创建 `NoteEditorActivity.kt`（笔记编辑）
- [ ] 实现富文本编辑（Markdown）
- [ ] 实现笔记标签功能
- [ ] 实现笔记搜索功能
- [ ] 实现笔记导出功能

#### 测试
- [ ] 测试笔记保存
- [ ] 测试 Markdown 渲染
- [ ] 测试笔记搜索

---

### 模块 4.2：套牌对比

#### 后端开发
- [ ] 创建 `DeckComparisonActivity.kt`
- [ ] 实现套牌差异分析逻辑
- [ ] 实现差异高亮算法

#### UI 开发
- [ ] 设计左右分栏布局
- [ ] 实现差异高亮显示
- [ ] 添加颜色标记（绿/红/黄）
- [ ] 添加套牌选择器

#### 测试
- [ ] 测试对比准确性
- [ ] 测试 UI 性能

---

## 💾 v4.5.0 - 离线与多数据源（第 15-16 周）

### 模块 5.1：离线模式

#### 后端开发
- [ ] 创建 `DeckCacheManager.kt`
- [ ] 创建 `CardCacheManager.kt`
- [ ] 实现 LRU 缓存策略
- [ ] 实现最近查看自动缓存
- [ ] 实现收藏优先缓存
- [ ] 实现手动下载功能

#### UI 开发
- [ ] 设置中添加"离线模式"开关
- [ ] 添加"下载全部"按钮
- [ ] 显示缓存大小
- [ ] 添加清除缓存功能

#### 测试
- [ ] 测试离线查看套牌
- [ ] 测试离线搜索
- [ ] 测试缓存管理

---

### 模块 5.2：多数据源支持

#### 后端开发
- [ ] 创建 `DataSource` 接口
- [ ] 实现 `MtgoMeleeSource.kt`
- [ ] 实现 `EdhrecSource.kt`
- [ ] 实现 `GoldfishSource.kt`
- [ ] 创建 `DataSourceManager.kt`
- [ ] 实现数据源统一接口

#### UI 开发
- [ ] 添加数据源选择器
- [ ] 显示数据来源标识

#### 测试
- [ ] 测试各数据源
- [ ] 测试数据合并

---

## 🎮 v4.6.0 - 比赛工具（第 17-18 周）

### 模块 6：生命计数器和换备工具

#### 子功能 6.1：生命计数器

#### UI 开发
- [ ] 创建 `LifeCounterActivity.kt`
- [ ] 实现 2 人模式
- [ ] 实现 4 人模式
- [ ] 实现生命值加减
- [ ] 实现毒指示物
- [ ] 实现能量指示物
- [ ] 实现历史记录
- [ ] 实现回退功能

#### 测试
- [ ] 测试各种模式
- [ ] 测试历史记录

---

#### 子功能 6.2：换备提醒器

#### 数据库
- [ ] 创建 `sideboard_guides` 表
- [ ] 创建 `SideboardGuideEntity.kt`

#### 后端开发
- [ ] 创建 `SideboardHelperActivity.kt`
- [ ] 实现换备记录功能
- [ ] 实现针对 Archetype 的换备指南

#### UI 开发
- [ ] 创建换备列表界面
- [ ] 实现快速勾选卡牌
- [ ] 实现导出换备列表

#### 测试
- [ ] 测试换备记录
- [ ] 测试导出功能

---

## 🌐 v4.7.0 - 社交功能（第 19-20 周）

### 模块 7.1：分享功能

#### 依赖添加
- [ ] 添加 ZXing 二维码库

#### 后端开发
- [ ] 创建 `SharePosterGenerator.kt`
- [ ] 实现海报 Canvas 绘制
- [ ] 实现二维码生成
- [ ] 实现分享链接生成

#### UI 开发
- [ ] 添加分享按钮
- [ ] 设计海报模板
- [ ] 实现分享到微信
- [ ] 实现分享到朋友圈
- [ ] 实现分享到 QQ
- [ ] 实现分享到微博

#### 测试
- [ ] 测试海报生成
- [ ] 测试各平台分享

---

## 🔄 v4.8.0 - 赛制扩充（第 21-22 周）

### 模块 8：新赛制支持

#### 指挥官（Commander）
- [ ] 实现 99+1 卡牌显示
- [ ] 实现颜色身份显示
- [ ] 实现基本地自动补全建议
- [ ] 优化套牌导出格式

#### 双头巨人（2HG）
- [ ] 实现 2 人队伍套牌显示
- [ ] 调整 UI 布局

#### 限制赛（Sealed/Draft）
- [ ] 实现牌池评分工具
- [ ] 实现卡牌 Pick 建议
- [ ] 添加限制赛专用 UI

#### 测试
- [ ] 测试各赛制功能

---

## 🤖 v5.0.0 - AI 助手（第 23-26 周）

### 模块 9：AI 分析助手

#### API 集成
- [ ] 选择 AI 提供商（OpenAI/Claude）
- [ ] 添加 API 客户端依赖
- [ ] 创建 `AIAdvisorService.kt`
- [ ] 实现 API 调用逻辑

#### 后端开发
- [ ] 实现套牌弱点分析
- [ ] 实现改进建议生成
- [ ] 实现 Sideboard Guide 生成
- [ ] 实现卡牌替换建议
- [ ] 实现自然语言查询

#### UI 开发
- [ ] 添加 AI 助手入口
- [ ] 创建 `AIAdvisorActivity.kt`
- [ ] 实现聊天界面
- [ ] 实现 API Key 设置
- [ ] 实现用量统计

#### 隐私和安全
- [ ] 实现套牌数据 hash
- [ ] 添加隐私说明
- [ ] 实现本地缓存 AI 回复

#### 测试
- [ ] 测试各 AI 功能
- [ ] 测试 API 限流
- [ ] 测试隐私保护

---

## 🧹 技术债务（持续进行）

### 测试
- [ ] 单元测试覆盖率达到 60%
- [ ] 添加 ViewModel 测试
- [ ] 添加 Repository 测试
- [ ] 添加 UI 测试（Espresso）

### 性能
- [ ] 使用 LeakCanary 检查内存泄漏
- [ ] 使用 Profiler 优化性能
- [ ] 优化启动速度
- [ ] 优化 APK 体积

### 代码质量
- [ ] 代码审查
- [ ] 重构复杂代码
- [ ] 统一代码风格
- [ ] 添加文档注释

### 安全
- [ ] 检查权限使用
- [ ] 加密敏感数据
- [ ] 实现 SSL Pinning

---

## 📱 版本发布

### 发布前检查清单
- [ ] 更新版本号（versionCode 和 versionName）
- [ ] 更新 CHANGELOG.md
- [ ] 运行所有测试
- [ ] 检查崩溃率
- [ ] 检查性能指标
- [ ] 准备 Release Notes
- [ ] 构建 Release APK
- [ ] 签名 APK
- [ ] 上传到应用商店
- [ ] 通知用户更新

---

**最后更新：** 2026-01-31
**当前版本：** v4.0.0
**下一个版本：** v4.1.0
