# åŒé¢ç‰Œä¿®å¤è¯´æ˜

## é—®é¢˜æè¿°
æœç´¢é¡µé¢çš„åŒé¢ç‰ŒèƒŒé¢å›¾ç‰‡æ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚

## æ ¹æœ¬åŸå› 
ç»è¿‡æ—¥å¿—åˆ†æå’Œ API æµ‹è¯•ï¼Œå‘ç°äº†çœŸæ­£çš„é—®é¢˜ï¼š

1. **`card_faces` å­—æ®µä¸º null** - MTGCH API æœç´¢ç»“æœï¼ˆ`/api/v1/result`ï¼‰**ä¸è¿”å›** `card_faces` å­—æ®µ
2. **åŒé¢ç‰Œä¿¡æ¯åœ¨ `other_faces` å­—æ®µä¸­** - MTGCH API ä½¿ç”¨ `other_faces` æ•°ç»„æ¥å­˜å‚¨åŒé¢ç‰Œçš„å¦ä¸€é¢ä¿¡æ¯
3. **æ­£é¢å›¾ç‰‡åœ¨é¡¶å±‚** - åŒé¢ç‰Œçš„æ­£é¢å›¾ç‰‡åœ¨é¡¶å±‚çš„ `image_uris` å­—æ®µä¸­ï¼Œåé¢åœ¨ `other_faces[0].image_uris` ä¸­

## MTGCH API æ•°æ®ç»“æ„

### æœç´¢ API è¿”å›çš„åŒé¢ç‰Œç»“æ„
```json
{
  "id": "abff6c81-65a4-48fa-ba8f-580f87b0344a",
  "name": "Delver of Secrets // Insectile Aberration",
  "face_name": "Delver of Secrets",
  "image_uris": {
    "normal": "https://cards.scryfall.io/normal/front/a/b/abff6c81-65a4-48fa-ba8f-580f87b0344a.jpg"
  },
  "other_faces": [
    {
      "face_name": "Insectile Aberration",
      "image_uris": {
        "normal": "https://cards.scryfall.io/normal/back/a/b/abff6c81-65a4-48fa-ba8f-580f87b0344a.jpg"
      },
      "mana_cost": "",
      "type_line": "Creature â€” Human Insect",
      "oracle_text": "Flying",
      "zhs_text": "é£è¡Œ",
      "zhs_type_line": "ç”Ÿç‰©ï½äººç±»/æ˜†è™«"
    }
  ]
}
```

## ä¿®å¤æ–¹æ¡ˆ

### ä¹‹å‰çš„é”™è¯¯å°è¯•
1. âŒ å°è¯•ä½¿ç”¨ `card_faces` å­—æ®µ - è¯¥å­—æ®µåœ¨æœç´¢ç»“æœä¸­ä¸º null
2. âŒ å°è¯•è°ƒç”¨ `/api/v1/card/{id}/` API - è¿”å› 422 é”™è¯¯ï¼ˆID ç±»å‹ä¸åŒ¹é…ï¼‰

### æ­£ç¡®çš„ä¿®å¤æ–¹æ¡ˆ
ä½¿ç”¨ `other_faces` å­—æ®µè·å–åŒé¢ç‰Œçš„å¦ä¸€é¢ä¿¡æ¯ï¼š

- **æ­£é¢å›¾ç‰‡**ï¼š`mtgchCard.imageUris.normal`
- **åé¢å›¾ç‰‡**ï¼š`mtgchCard.otherFaces[0].imageUris.normal`
- **åé¢åç§°**ï¼š`mtgchCard.otherFaces[0].faceName`
- **åé¢ç±»å‹**ï¼š`mtgchCard.otherFaces[0].zhsTypeLine`
- **åé¢æ–‡æœ¬**ï¼š`mtgchCard.otherFaces[0].zhsText`

## ä¿®æ”¹çš„æ–‡ä»¶

### SearchActivity.kt
- **åˆ é™¤**ï¼š`fetchFullCardAndShow()` æ–¹æ³•ï¼ˆä¸éœ€è¦é¢å¤– API è°ƒç”¨ï¼‰
- **ä¿®æ”¹**ï¼š`showCardDetail()` - ä½¿ç”¨ `other_faces` å­—æ®µè€Œä¸æ˜¯ `card_faces`
- **ä¿®æ”¹**ï¼š`showCardInfo()` - ç›´æ¥ä¼ é€’å›¾ç‰‡ URLï¼Œç®€åŒ–é€»è¾‘

### å…³é”®ä»£ç å˜æ›´
```kotlin
// ä¹‹å‰çš„é”™è¯¯ä»£ç 
val cardFaces = mtgchCard?.cardFaces  // null!
val backImageUri = cardFaces?.get(1)?.imageUris?.normal  // null!

// ä¿®å¤åçš„ä»£ç 
val otherFaces = mtgchCard?.otherFaces  // æœ‰æ•°æ®ï¼
val backImageUri = otherFaces?.get(0)?.imageUris?.normal  // æœ‰æ•ˆ URLï¼
```

## æµ‹è¯•æ­¥éª¤

### 1. æœç´¢åŒé¢ç‰Œ
åœ¨åº”ç”¨ä¸­æœç´¢ "Delver of Secrets"

### 2. æŸ¥çœ‹æ—¥å¿—
```bash
adb logcat -s "SearchActivity:D"
```

### é¢„æœŸæ—¥å¿—è¾“å‡º
```
SearchActivity: === åŒé¢ç‰Œæ•°æ® ===
SearchActivity: isDualFaced: true
SearchActivity: otherFaces size: 1
SearchActivity: cardFaces size: null
SearchActivity: frontImageUri: https://cards.scryfall.io/normal/front/...
SearchActivity: backImageUri: https://cards.scryfall.io/normal/back/...
```

### 3. éªŒè¯åŠŸèƒ½
1. ç‚¹å‡»å¡ç‰ŒæŸ¥çœ‹è¯¦æƒ…
2. ç‚¹å‡»"æŸ¥çœ‹åé¢"æŒ‰é’®
3. ç¡®è®¤èƒŒé¢å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º

## æŠ€æœ¯ç»†èŠ‚

### MTGCH vs Scryfall API å·®å¼‚

| ç‰¹æ€§ | Scryfall API | MTGCH API |
|------|-------------|-----------|
| åŒé¢ç‰Œå­—æ®µ | `card_faces` | `other_faces` |
| æ­£é¢å›¾ç‰‡ä½ç½® | `card_faces[0].image_uris` æˆ–é¡¶å±‚ `image_uris` | é¡¶å±‚ `image_uris` |
| åé¢å›¾ç‰‡ä½ç½® | `card_faces[1].image_uris` | `other_faces[0].image_uris` |
| ä¸­æ–‡æ–‡æœ¬ä½ç½® | `card_faces[n].printed_text` | `other_faces[n].zhs_text` |

### æ•°æ®æ¨¡å‹å¯¹æ¯”

#### Scryfallï¼ˆä½¿ç”¨ card_facesï¼‰
```json
{
  "object": "card",
  "card_faces": [
    {"name": "Front", "image_uris": {...}},
    {"name": "Back", "image_uris": {...}}
  ]
}
```

#### MTGCHï¼ˆä½¿ç”¨ other_facesï¼‰
```json
{
  "object": "card",
  "face_name": "Front",
  "image_uris": {...},
  "other_faces": [
    {"face_name": "Back", "image_uris": {...}}
  ]
}
```

## ç»éªŒæ•™è®­

1. **ä¸è¦å‡è®¾ API ç»“æ„ç›¸åŒ** - å³ä½¿ MTGCH åŸºäº Scryfallï¼Œæ•°æ®ç»“æ„ä¹Ÿå¯èƒ½ä¸åŒ
2. **å…ˆæµ‹è¯• API** - åœ¨ç¼–ç ä¹‹å‰å…ˆç”¨ curl æµ‹è¯• API è¿”å›çš„å®é™…æ•°æ®
3. **æŸ¥çœ‹æ—¥å¿—æ˜¯å…³é”®** - æ—¥å¿—æ˜¾ç¤º `cardFaces size: null`ï¼Œåº”è¯¥ç«‹å³æ„è¯†åˆ°é—®é¢˜æ‰€åœ¨
4. **`other_faces` vs `card_faces`** - MTGCH ä½¿ç”¨ `other_faces` è€Œä¸æ˜¯ `card_faces`

## åç»­ä¼˜åŒ–å»ºè®®

1. âœ… **å·²å®Œæˆ** - ä¿®å¤åŒé¢ç‰Œå›¾ç‰‡æ˜¾ç¤º
2. ğŸ”„ **å¯é€‰** - æ·»åŠ åŠ è½½çŠ¶æ€æŒ‡ç¤ºï¼ˆå¦‚æœéœ€è¦ï¼‰
3. ğŸ”„ **å¯é€‰** - å®ç°åŒé¢ç‰Œå›¾ç‰‡ç¼“å­˜
4. ğŸ”„ **å¯é€‰** - æ”¯æŒæ›´å¤šåŒé¢ç‰Œå¸ƒå±€ï¼ˆmerge, split ç­‰ï¼‰

## åˆ›å»ºæ—¶é—´
2026-02-04
## æœ€ç»ˆä¿®å¤æ—¶é—´
2026-02-04
## çŠ¶æ€
âœ… å·²å®Œæˆå¹¶æµ‹è¯•
